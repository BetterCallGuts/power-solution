{% extends 'components/base.html' %}
{% load static %}

{% block meta_description %}
power solution ferbo {{ferbo.name}} details 
xcel sheet for {{ferbo.name}}
{% endblock %}

{% block twitter_description %}
power solution ferbo {{ferbo.name}} details 
xcel sheet for {{ferbo.name}}
{% endblock %}

{% block og_image %}{{ferbo.image.url}}{% endblock %}
{% block og_description %}
power solution ferbo {{ferbo.name}} details 
xcel sheet for {{ferbo.name}}
{% endblock %}
{% block og_title %}power solution {{ferbo.name}} details{% endblock %}

{% block meta_keywords %}ferbo {{ferbo.name}} details, ferbo, Power Solution, Generators, UPS, Accessories, Power Solution, {{ferbo.name}} {% endblock %}

{% block title %}{{ ferbo.name }} Details{% endblock %}

{% block css %}
<style>
    table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: center;
        word-wrap: break-word; 
    }
    th {
        background-color: #f4f4f4;
        font-weight: bold;
    }

    .table-container {
        max-width: 100%; 
        overflow-x: auto; 
        overflow-y: hidden; 
        text-wrap: nowrap;
    }
    table {
        min-width: 100%; 
        border-collapse: collapse;
        margin-top: 20px;
    }
    .table-container thead th{
        text-align: center;
    }
</style>
{% endblock %}

{% block content %}
<h1 class="text-center py-5 px-5" style="color: #032931;">Contents of {{ ferbo.name }}'s Excel File</h1>
<section class="container rounded-2 my-5 p-5 w-100 bg-dark text-light">
    <div class="table-container">
        <table 
        class="fs-4 fw-bold table table-bordered table-light"
        id="excel-table">
        <thead class="table-dark bg-dark">

           <tr>
            <th >Model</th>
            <th >POWER PRP</th>
            <th>POWER LTP</th>
            <th >ENGINE TYPE	</th>
            <th colspan="3">ALTERNATOR</th>
            <th>DIMENSIONS L X W X H</th>
            <th>WEIGHT</th>
           </tr>

           <!--  -->
           <tr>
            <th></th>
            <th>KVA</th>
            <th>KVA</th>
            <th></th>
            <th>LEROY</th>
            <th>MEC</th>
            <th>STAM</th>
            <th>mm</th>
            <th>kg</th>
           </tr>
           </thead>
<!--  -->
        <tbody>

        </tbody>

        </table>
    </div>
</section>



{% endblock %}

{% block js %}
<script src="{% static 'framework/js/xlsx.js' %}"></script>

<script>

const fileUrl = "{{ ferbo.xlsx.url }}"; 
let firstOp   = true 
async function displayExcel() {
    const response = await fetch(fileUrl);
    const arrayBuffer = await response.arrayBuffer();
    const data = new Uint8Array(arrayBuffer);
    const workbook = XLSX.read(data, { type: "array" });


    const sheetName = workbook.SheetNames[0];
    const worksheet = workbook.Sheets[sheetName];

    let sheetData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
    sheetData = sheetData.slice(1)
    firstRow  = sheetData.shift()
    sheetData = sheetData.slice(1)
    secRow    =     firstRow  = sheetData.shift()
    sheetData.pop()
// starter operation and handler of the xlsx Formate





// 

    console.log(sheetData)
    const table = document.querySelector("#excel-table tbody");
    table.innerHTML = ""; 

    sheetData.slice(2).forEach(row => {
        const tr = document.createElement("tr");
        if (firstOp){
            firstOp = !firstOp
            const name = row[0]
            const powerPRP = row[1]
            const powerLTP = row[2]
            const engineType = row[3]
            const leroy      = row[4]
            const mec        = row[5]
            const stam       = row[6]
            const mm         = row[7]
            const Kg         = row[8]
            var tdName = document.createElement("td");
            tdName.textContent = name !== undefined ? name : ""; 

            var tdpowerPRP = document.createElement("td");
            tdpowerPRP.textContent = powerPRP !== undefined ? powerPRP : "";



        } else{
            firstOp = !firstOp
        }
        row.forEach(cell => {

            const td = document.createElement("td");
            td.textContent = cell !== undefined ? cell : ""; 
            
            tr.appendChild(td);
        });
        table.appendChild(tr);
    });
}


displayExcel();

</script>

{% endblock %}
